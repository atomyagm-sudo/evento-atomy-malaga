<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pet Portrait AI V2 - Estilo Principal Blanco y Negro</title>
    <meta name="description" content="Crea retratos art√≠sticos en blanco y negro con perros apilados usando IA">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #8B5CF6;
            --primary-dark: #7C3AED;
            --secondary: #EC4899;
            --accent: #06B6D4;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --light: #F8FAFC;
            --dark: #1E293B;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f0f4ff 0%, #fdf2ff 50%, #f0f9ff 100%);
            min-height: 100vh;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
        }
        
        .file-upload-card {
            border: 2px dashed #d1d5db;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: linear-gradient(135deg, #fafafa 0%, #ffffff 100%);
        }
        .file-upload-card.drag-over {
            border-color: var(--primary);
            background: linear-gradient(135deg, #f0f2ff 0%, #faf5ff 100%);
            transform: scale(1.02);
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.15);
        }
        
        .loader {
            border: 6px solid #f3f3f3;
            border-top: 6px solid var(--primary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .btn-primary {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 12px 28px rgba(139, 92, 246, 0.3);
        }
        
        .progress-bar {
            height: 4px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 50%, var(--primary) 100%);
            background-size: 200% 100%;
            animation: shimmer 2s linear infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .style-card {
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            border: 2px solid transparent;
            background: white;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }
        
        .style-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
        }
        
        .style-card.selected {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2), 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .style-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(4px);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .viral-badge {
            background: linear-gradient(135deg, #FF6B6B, #FF8E53);
            color: white;
        }
        
        .trending-badge {
            background: linear-gradient(135deg, #4FACFE, #00F2FE);
            color: white;
        }
        
        .classic-badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .floating {
            animation: float 6s ease-in-out infinite;
        }
        
        .pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes pulse-glow {
            from { box-shadow: 0 0 10px rgba(139, 92, 246, 0.4); }
            to { box-shadow: 0 0 20px rgba(139, 92, 246, 0.8); }
        }
        
        .gradient-text {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .notification {
            position: fixed;
            top: 2rem;
            right: 2rem;
            z-index: 1000;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 1rem;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }
        .notification.show {
            transform: translateX(0);
        }
        .notification.success {
            border-left: 4px solid var(--success);
        }
        .notification.error {
            border-left: 4px solid var(--error);
        }
        
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .bw-filter {
            filter: grayscale(100%) contrast(120%);
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Notificaci√≥n -->
    <div id="notification" class="notification">
        <div class="notification-icon">
            <i class="fas fa-check-circle text-green-500"></i>
        </div>
        <div class="notification-content">
            <p class="font-medium" id="notification-text">¬°Operaci√≥n completada!</p>
        </div>
        <button class="notification-close ml-auto text-gray-400 hover:text-gray-600">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        
        <header class="text-center mb-8 md:mb-12 fade-in">
            <div class="flex justify-center mb-4">
                <div class="relative floating">
                    <div class="w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center shadow-lg pulse-glow">
                        <i class="fas fa-paw text-white text-3xl"></i>
                    </div>
                    <div class="absolute -top-2 -right-2 bg-amber-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-md">
                        V2
                    </div>
                </div>
            </div>
            <h1 class="text-4xl md:text-6xl font-black gradient-text mb-3">
                Pet Portrait AI
            </h1>
            <p class="text-lg md:text-xl text-gray-700 mt-4 font-medium max-w-2xl mx-auto">Crea retratos en blanco y negro con perros apilados - El estilo cl√°sico</p>
            
            <!-- Indicador de pasos -->
            <div class="flex justify-center mt-8 space-x-2">
                <div class="step w-10 h-10 bg-purple-500 text-white rounded-full flex items-center justify-center font-bold">1</div>
                <div class="step-line h-1 bg-gray-300 w-16 mt-5"></div>
                <div class="step w-10 h-10 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center font-bold">2</div>
                <div class="step-line h-1 bg-gray-300 w-16 mt-5"></div>
                <div class="step w-10 h-10 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center font-bold">3</div>
                <div class="step-line h-1 bg-gray-300 w-16 mt-5"></div>
                <div class="step w-10 h-10 bg-gray-300 text-gray-600 rounded-full flex items-center justify-center font-bold">4</div>
            </div>
        </header>

        <main class="grid grid-cols-1 xl:grid-cols-3 gap-8 items-start">
            <!-- Columna izquierda: Formulario -->
            <div class="xl:col-span-2 space-y-6">
                
                <!-- Paso 1: Subir selfie -->
                <div class="glass-card p-6 rounded-2xl fade-in" id="step-1-card">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold">1</div>
                        <h2 class="text-xl font-bold text-gray-800">Sube tu selfie üë§</h2>
                    </div>
                    <p class="text-gray-600 mb-4">Comienza subiendo una foto clara de tu rostro para crear el retrato base.</p>
                    
                    <div id="selfie-drop-area" class="file-upload-card p-8 text-center rounded-xl cursor-pointer transition-all duration-300">
                        <input type="file" id="selfie-input" accept="image/png, image/jpeg, image/webp" class="hidden">
                        <div class="text-gray-500">
                            <div class="w-20 h-20 mx-auto bg-gradient-to-r from-purple-100 to-pink-100 rounded-full flex items-center justify-center mb-4">
                                <i class="fas fa-user text-purple-500 text-2xl"></i>
                            </div>
                            <p class="text-lg font-semibold">Arrastra tu selfie aqu√≠</p>
                            <p class="text-sm text-gray-400 mt-2">o haz clic para seleccionar</p>
                            <p class="text-xs text-gray-400 mt-1">Formatos: JPG, PNG, WebP</p>
                        </div>
                    </div>
                    
                    <div id="selfie-preview-container" class="mt-4 hidden">
                        <p class="font-medium text-sm text-gray-600 mb-2">Vista previa:</p>
                        <div id="selfie-preview" class="flex justify-center items-center gap-4"></div>
                    </div>
                </div>

                <!-- Paso 2: Subir fotos de mascotas -->
                <div class="glass-card p-6 rounded-2xl fade-in" id="step-2-card">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center text-white font-bold">2</div>
                        <h2 class="text-xl font-bold text-gray-800">Sube fotos de tus mascotas üêï</h2>
                    </div>
                    <p class="text-gray-600 mb-4">A√±ade fotos de tus mascotas para incluirlas en el retrato art√≠stico.</p>
                    
                    <div id="dogs-drop-area" class="file-upload-card p-8 text-center rounded-xl cursor-pointer transition-all duration-300">
                        <input type="file" id="dogs-input" accept="image/png, image/jpeg, image/webp" multiple class="hidden">
                        <div class="text-gray-500">
                            <div class="w-20 h-20 mx-auto bg-gradient-to-r from-blue-100 to-cyan-100 rounded-full flex items-center justify-center mb-4">
                                <i class="fas fa-paw text-blue-500 text-2xl"></i>
                            </div>
                            <p class="text-lg font-semibold">Arrastra fotos de mascotas aqu√≠</p>
                            <p class="text-sm text-gray-400 mt-2">o haz clic para seleccionar</p>
                            <p class="text-xs text-gray-400 mt-1">Puedes subir hasta 5 mascotas</p>
                        </div>
                    </div>
                    
                    <div id="dogs-previews-container" class="mt-4 hidden">
                        <p class="font-medium text-sm text-gray-600 mb-2">Tus mascotas:</p>
                        <div id="dog-previews" class="flex flex-wrap gap-3 justify-center"></div>
                    </div>
                </div>
                
                <!-- Paso 3: Elegir estilo -->
                <div class="glass-card p-6 rounded-2xl fade-in" id="step-3-card">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-10 h-10 bg-gradient-to-r from-pink-500 to-rose-500 rounded-full flex items-center justify-center text-white font-bold">3</div>
                        <h2 class="text-xl font-bold text-gray-800">Elige el estilo art√≠stico üé®</h2>
                    </div>
                    <p class="text-gray-600 mb-4">Selecciona el estilo cl√°sico de blanco y negro con perros apilados o explora otras opciones virales.</p>
                    
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6" id="style-cards">
                        <!-- Las tarjetas de estilo se generar√°n con JavaScript -->
                    </div>
                </div>

                <!-- Paso 4: Generar -->
                <div class="glass-card p-6 rounded-2xl fade-in" id="step-4-card">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center text-white font-bold">4</div>
                        <h2 class="text-xl font-bold text-gray-800">¬°Crea la magia! ‚ú®</h2>
                    </div>
                    <p class="text-gray-600 mb-4">Todo listo. Haz clic en el bot√≥n para generar tu retrato art√≠stico √∫nico con el estilo cl√°sico.</p>
                    
                    <button id="generate-btn" class="btn-primary w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-black py-4 px-6 rounded-xl shadow-lg text-lg transition-all duration-300" disabled>
                        <span class="flex items-center justify-center gap-3">
                            <i class="fas fa-wand-magic-sparkles"></i>
                            Generar Retrato Cl√°sico
                        </span>
                    </button>
                </div>
            </div>

            <!-- Columna derecha: Vista previa y resultados -->
            <div class="space-y-6">
                
                <!-- Vista previa del estilo -->
                <div id="example-column" class="glass-card p-6 rounded-2xl relative min-h-[500px] flex flex-col">
                    <div class="absolute top-4 right-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-semibold px-3 py-1 rounded-full shadow-md">
                        Vista Previa
                    </div>
                    <h2 class="text-xl font-bold text-gray-800 mb-4">‚ú® Previsualizaci√≥n del Estilo</h2>

                    <div class="relative my-4 flex-1 flex items-center justify-center">
                        <div class="w-full h-64 bg-gradient-to-br from-gray-100 to-gray-200 rounded-xl flex items-center justify-center">
                            <img id="style-example-image" src="https://images.unsplash.com/photo-1514989940723-e8e51635b782?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" alt="Ejemplo de estilo art√≠stico" class="rounded-lg w-full h-full object-cover shadow-md bw-filter">
                        </div>
                    </div>

                    <div class="mt-4">
                        <h3 class="font-semibold text-gray-700 mb-2">Caracter√≠sticas del estilo:</h3>
                        <ul id="style-features" class="space-y-2 text-gray-600">
                            <li class="flex items-start gap-2">
                                <i class="fas fa-check text-green-500 mt-1"></i>
                                <span>Blanco y negro art√≠stico de alta calidad</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fas fa-check text-green-500 mt-1"></i>
                                <span>Composici√≥n de cabezas apiladas</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fas fa-check text-green-500 mt-1"></i>
                                <span>Enfoque en la conexi√≥n emocional</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Mensaje de carga -->
                <div id="message-column" class="hidden glass-card p-6 rounded-2xl text-center flex flex-col justify-center items-center min-h-[400px] fade-in">
                    <div class="loader mb-6"></div>
                    <h3 id="message-title" class="text-2xl font-black text-gray-800 mb-2">Creando tu retrato cl√°sico...</h3>
                    <p id="message-text" class="text-gray-600 mt-2 max-w-md">Estamos procesando tus im√°genes para crear el retrato en blanco y negro con perros apilados.</p>
                    <div class="w-full max-w-xs mt-6">
                        <div class="progress-bar rounded-full"></div>
                    </div>
                    <div class="mt-6 grid grid-cols-3 gap-2 max-w-xs">
                        <div class="h-2 bg-purple-200 rounded-full animate-pulse"></div>
                        <div class="h-2 bg-purple-300 rounded-full animate-pulse delay-100"></div>
                        <div class="h-2 bg-purple-400 rounded-full animate-pulse delay-200"></div>
                    </div>
                </div>

                <!-- Resultados -->
                <div id="result-column" class="hidden glass-card p-6 rounded-2xl">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <i class="fas fa-sparkles text-yellow-500"></i>
                        <span>üéâ ¬°Tu Retrato Cl√°sico Est√° Listo!</span>
                    </h2>
                    
                    <div id="portrait-result-section" class="mb-6">
                        <h3 class="text-xl font-semibold text-gray-700 mb-3">Retrato en Blanco y Negro con Perros Apilados</h3>
                        <div id="result-image-container" class="mb-4 rounded-xl overflow-hidden border-2 border-gray-300 bg-gray-50 min-h-[300px] flex items-center justify-center">
                            <img id="result-image" src="" alt="Retrato generado por IA" class="w-full h-auto max-h-96 object-contain">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3 mt-4">
                            <button id="download-btn" class="btn-primary bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-3 px-4 rounded-lg shadow-md flex items-center justify-center gap-2">
                                <i class="fas fa-download"></i>
                                Descargar
                            </button>
                            <button id="regenerate-btn" class="btn-primary bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-bold py-3 px-4 rounded-lg shadow-md flex items-center justify-center gap-2">
                                <i class="fas fa-sync-alt"></i>
                                Regenerar
                            </button>
                        </div>
                    </div>

                    <button id="start-over-btn" class="btn-primary w-full bg-gray-200 text-gray-800 font-bold py-3 px-4 rounded-lg hover:bg-gray-300 flex items-center justify-center gap-2 mt-3">
                        <i class="fas fa-redo"></i>
                        Crear Otro Retrato
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal de alerta -->
    <div id="custom-alert" class="modal-backdrop hidden">
        <div class="bg-white p-6 rounded-2xl shadow-xl max-w-md w-full mx-4">
            <div class="text-center mb-4">
                <div class="w-16 h-16 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-info text-white text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-800 mb-2" id="alert-title">Informaci√≥n</h3>
                <p id="alert-message" class="text-gray-600"></p>
            </div>
            <button id="alert-close-btn" class="btn-primary w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold py-3 px-4 rounded-lg shadow-lg mt-4">
                Entendido
            </button>
        </div>
    </div>

    <script>
        // Configuraci√≥n de la API
        const API_KEY = "AIzaSyCIcKllMAMgqfY5pXAvkRZFjp56TMq5AUQ";
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;

        // Estado de la aplicaci√≥n
        let selfieFile = null;
        let dogFiles = [];
        let selectedStyle = null;
        let isGenerating = false;

        // Estilos con el principal en blanco y negro
        const styles = {
            'fine_art_bw': {
                name: 'Cl√°sico Blanco y Negro üñ§',
                description: `Create a professional black and white fine art portrait in the style of a master photographer. A person resting their head on a soft surface with EXACTLY {numDogs} dogs with their heads stacked one on top of the other, gently leaning on the person's head and shoulder. Create an intimate, calm, emotional composition with soft natural window light, shallow depth of field, and cinematic mood. High-resolution with fine skin detail and visible dog fur texture. Neutral background out of focus (bokeh). All subjects looking directly into the camera lens. Shot on a professional camera (Canon RF 50mm f/1.2 or similar). Moody, editorial style, minimal distractions, focus on the emotional bond between human and pets. Black and white photography with perfect contrast and tonality.`,
                details: 'El estilo cl√°sico: blanco y negro profesional con perros apilados. Atemporal y emotivo.',
                features: [
                    'Blanco y negro art√≠stico profesional',
                    'Composici√≥n de cabezas apiladas',
                    'Alta resoluci√≥n con texturas detalladas',
                    'Fondo desenfocado (efecto bokeh)',
                    'Enfoque en la conexi√≥n emocional'
                ],
                example_image: "https://images.unsplash.com/photo-1514989940723-e8e51635b782?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80",
                badge: "classic",
                popularity: 98
            },
            'dreamy_glow': {
                name: 'Brillo So√±ador ‚ú®',
                description: `Create a highly viral, dreamy portrait with soft golden hour lighting, lens flare effects, and a magical atmosphere. A person resting their head on a soft surface with EXACTLY {numDogs} dogs with their heads stacked, gently leaning on the person's head and shoulder. The image has a soft focus effect, warm pastel tones, and an ethereal glow. The background is a dreamy out-of-focus landscape with bokeh lights. The overall mood is magical, serene, and highly Instagrammable with a touch of fantasy. The composition is perfectly balanced for social media, with high emotional appeal and shareability.`,
                details: 'Efecto de luz dorada, atm√≥sfera so√±adora y m√°gica. Perfecto para Instagram y TikTok.',
                features: [
                    'Efecto de Luz Dorada y Brillos M√°gicos',
                    'Atm√≥sfera Et√©rea y So√±adora',
                    'Colores Pastel C√°lidos y Vibrantes',
                    'Composici√≥n Optimizada para Redes Sociales',
                    'Alto Potencial Viral'
                ],
                example_image: "https://images.unsplash.com/photo-1518481852452-9415b262eba4?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                badge: "viral",
                popularity: 95
            },
            'kawaii_cute': {
                name: 'Kawaii Adorable üç°',
                description: `Create an ultra-cute kawaii style portrait designed for maximum viral potential. A person resting their head with EXACTLY {numDogs} dogs with their heads stacked, using soft pastel colors, round faces, huge sparkling eyes, and tiny mouths. Added cute elements like floating hearts, stars, sparkles, and rainbows around the subjects. The style is extremely charming, innocent, and adorable with authentic Japanese kawaii aesthetic. All subjects have exaggerated cute expressions that trigger positive emotional responses. The background is simple and pastel-colored to keep focus on the cute characters. Perfect for stickers, social media, and messaging apps.`,
                details: 'Estilo japon√©s super adorable con colores pastel y elementos kawaii. Altamente compartible.',
                features: [
                    'Caras Redondas y Ojos Grandes Expresivos',
                    'Colores Pastel Suaves y Alegres',
                    'Elementos Kawaii (Corazones, Estrellas, Sparkles)',
                    'Expresiones Exageradamente Adorables',
                    'Optimizado para Stickers y Redes Sociales'
                ],
                example_image: "https://images.unsplash.com/photo-1551103782-8ab07afd45c1?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                badge: "trending",
                popularity: 92
            },
            'cyberpunk_neon': {
                name: 'Cyberpunk Neon üèôÔ∏è',
                description: `Create a cyberpunk neon portrait with high visual impact and viral potential. A person resting their head with EXACTLY {numDogs} dogs with their heads stacked, set in a futuristic city at night with glowing neon signs, rain-soaked streets, and holographic advertisements. Used a dark color palette with vibrant neon accents (electric pinks, blues, greens). Added technological elements like circuit patterns, data streams, and glitch effects. The mood is futuristic, edgy, and visually striking with a Blade Runner aesthetic. The composition is dynamic and eye-catching, perfect for grabbing attention on social media feeds.`,
                details: 'Estilo futurista con luces de ne√≥n, lluvia y elementos tecnol√≥gicos. Muy popular en Instagram.',
                features: [
                    'Escena Nocturna con Luces de Ne√≥n Vibrantes',
                    'Atm√≥sfera Cyberpunk Futurista y Edgy',
                    'Efectos de Lluvia y Reflexiones en el Pavimento',
                    'Elementos Tecnol√≥gicos y Hologr√°ficos',
                    'Paleta de Colores Oscuros con Acentos Ne√≥n'
                ],
                example_image: "https://images.unsplash.com/photo-1488590528505-98d2b5aba04b?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                badge: "trending",
                popularity: 85
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            // Inicializar la aplicaci√≥n
            initializeApp();
        });

        function initializeApp() {
            // Generar tarjetas de estilos
            generateStyleCards();
            
            // Configurar eventos
            setupEventListeners();
            
            // Configurar sistema de notificaciones
            setupNotifications();
            
            // Seleccionar el estilo cl√°sico por defecto
            selectStyle('fine_art_bw');
        }

        function generateStyleCards() {
            const styleCardsContainer = document.getElementById('style-cards');
            styleCardsContainer.innerHTML = '';

            Object.keys(styles).forEach(key => {
                const style = styles[key];
                const styleCard = document.createElement('div');
                styleCard.className = 'style-card';
                styleCard.dataset.style = key;
                
                let badgeHTML = '';
                if (style.badge) {
                    badgeHTML = `<div class="style-badge ${style.badge}-badge">${style.badge.toUpperCase()}</div>`;
                }
                
                // Aplicar filtro blanco y negro solo al estilo cl√°sico
                const imageClass = key === 'fine_art_bw' ? 'bw-filter' : '';
                
                styleCard.innerHTML = `
                    ${badgeHTML}
                    <div class="h-32 bg-gradient-to-br from-purple-100 to-pink-100 flex items-center justify-center overflow-hidden">
                        <img src="${style.example_image}" alt="${style.name}" class="w-full h-full object-cover ${imageClass}">
                    </div>
                    <div class="p-4">
                        <h3 class="font-bold text-gray-800 mb-1">${style.name}</h3>
                        <p class="text-xs text-gray-600 mb-2">${style.details}</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full ${style.popularity > 85 ? 'bg-green-500' : style.popularity > 75 ? 'bg-yellow-500' : 'bg-blue-500'} mr-1"></div>
                                <span class="text-xs text-gray-500">${style.popularity}% popular</span>
                            </div>
                            <div class="text-xs font-medium text-purple-600">Seleccionar</div>
                        </div>
                    </div>
                `;
                
                styleCardsContainer.appendChild(styleCard);
                
                // A√±adir evento de clic
                styleCard.addEventListener('click', () => {
                    selectStyle(key);
                });
            });
        }

        function selectStyle(styleKey) {
            // Remover selecci√≥n anterior
            document.querySelectorAll('.style-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Seleccionar nueva tarjeta
            document.querySelector(`[data-style="${styleKey}"]`).classList.add('selected');
            selectedStyle = styleKey;
            
            // Actualizar vista previa
            updateStyleDisplay(styleKey);
            updateGenerateButton();
            
            // Actualizar texto del bot√≥n seg√∫n el estilo
            const generateBtn = document.getElementById('generate-btn');
            if (styleKey === 'fine_art_bw') {
                generateBtn.innerHTML = `
                    <span class="flex items-center justify-center gap-3">
                        <i class="fas fa-wand-magic-sparkles"></i>
                        Generar Retrato Cl√°sico
                    </span>
                `;
            } else {
                generateBtn.innerHTML = `
                    <span class="flex items-center justify-center gap-3">
                        <i class="fas fa-wand-magic-sparkles"></i>
                        Generar con ${styles[styleKey].name.split(' ')[0]}
                    </span>
                `;
            }
        }

        function updateStyleDisplay(styleKey) {
            const style = styles[styleKey];
            if (!style) return;

            const exampleImage = document.getElementById('style-example-image');
            exampleImage.src = style.example_image;
            
            // Aplicar filtro blanco y negro solo al estilo cl√°sico
            if (styleKey === 'fine_art_bw') {
                exampleImage.classList.add('bw-filter');
            } else {
                exampleImage.classList.remove('bw-filter');
            }
            
            const styleFeatures = document.getElementById('style-features');
            styleFeatures.innerHTML = '';
            
            style.features.forEach(feature => {
                const li = document.createElement('li');
                li.className = 'flex items-start gap-2';
                li.innerHTML = `<i class="fas fa-check text-green-500 mt-1"></i> <span>${feature}</span>`;
                styleFeatures.appendChild(li);
            });
        }

        function setupEventListeners() {
            // Selfie upload
            const selfieDropArea = document.getElementById('selfie-drop-area');
            const selfieInput = document.getElementById('selfie-input');
            
            selfieDropArea.addEventListener('click', () => selfieInput.click());
            selfieInput.addEventListener('change', (e) => handleFileSelect(e, 'selfie'));
            
            // Dogs upload
            const dogsDropArea = document.getElementById('dogs-drop-area');
            const dogsInput = document.getElementById('dogs-input');
            
            dogsDropArea.addEventListener('click', () => dogsInput.click());
            dogsInput.addEventListener('change', (e) => handleFileSelect(e, 'dogs'));
            
            // Generate button
            document.getElementById('generate-btn').addEventListener('click', generateImage);
            
            // Regenerate button
            document.getElementById('regenerate-btn').addEventListener('click', generateImage);
            
            // Start over button
            document.getElementById('start-over-btn').addEventListener('click', resetApp);
            
            // Download button
            document.getElementById('download-btn').addEventListener('click', downloadImage);
            
            // Alert close button
            document.getElementById('alert-close-btn').addEventListener('click', () => {
                document.getElementById('custom-alert').classList.add('hidden');
            });
        }

        function handleFileSelect(event, type) {
            const files = event.target.files;
            if (!files || files.length === 0) return;
            
            if (type === 'selfie') {
                selfieFile = files[0];
                renderSelfiePreview();
            } else if (type === 'dogs') {
                // A√±adir nuevos archivos (m√°ximo 5)
                Array.from(files).forEach(file => {
                    if (dogFiles.length < 5) {
                        dogFiles.push(file);
                    }
                });
                renderDogPreviews();
            }
            
            updateGenerateButton();
        }

        function renderSelfiePreview() {
            const container = document.getElementById('selfie-preview-container');
            const preview = document.getElementById('selfie-preview');
            
            if (selfieFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `
                        <div class="relative">
                            <img src="${e.target.result}" class="preview-image w-24 h-24 rounded-xl object-cover shadow-md">
                            <button onclick="removeSelfie()" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs">
                                √ó
                            </button>
                        </div>
                    `;
                    container.classList.remove('hidden');
                };
                reader.readAsDataURL(selfieFile);
            } else {
                container.classList.add('hidden');
            }
        }

        function renderDogPreviews() {
            const container = document.getElementById('dogs-previews-container');
            const previews = document.getElementById('dog-previews');
            
            if (dogFiles.length > 0) {
                previews.innerHTML = '';
                
                dogFiles.forEach((file, index) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const div = document.createElement('div');
                        div.className = 'relative';
                        div.innerHTML = `
                            <img src="${e.target.result}" class="preview-image w-20 h-20 rounded-lg object-cover">
                            <button onclick="removeDog(${index})" class="absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">
                                √ó
                            </button>
                        `;
                        previews.appendChild(div);
                    };
                    reader.readAsDataURL(file);
                });
                
                container.classList.remove('hidden');
            } else {
                container.classList.add('hidden');
            }
        }

        function removeSelfie() {
            selfieFile = null;
            document.getElementById('selfie-input').value = '';
            renderSelfiePreview();
            updateGenerateButton();
        }

        function removeDog(index) {
            dogFiles.splice(index, 1);
            document.getElementById('dogs-input').value = '';
            renderDogPreviews();
            updateGenerateButton();
        }

        function updateGenerateButton() {
            const btn = document.getElementById('generate-btn');
            const hasRequiredFiles = selfieFile && dogFiles.length > 0 && selectedStyle;
            btn.disabled = !hasRequiredFiles || isGenerating;
        }

        async function generateImage() {
            if (isGenerating) return;
            
            if (!selfieFile || dogFiles.length === 0 || !selectedStyle) {
                showAlert('Error', 'Por favor, sube tu selfie, fotos de tus mascotas y selecciona un estilo.');
                return;
            }

            isGenerating = true;
            updateGenerateButton();
            
            // Mostrar mensaje de carga
            document.getElementById('example-column').classList.add('hidden');
            document.getElementById('message-column').classList.remove('hidden');
            document.getElementById('result-column').classList.add('hidden');

            try {
                // Simular generaci√≥n (en una implementaci√≥n real, aqu√≠ llamar√≠as a la API)
                setTimeout(() => {
                    // En una implementaci√≥n real, esto vendr√≠a de la API
                    const resultImage = document.getElementById('result-image');
                    
                    // Para el estilo cl√°sico, usar una imagen en blanco y negro
                    if (selectedStyle === 'fine_art_bw') {
                        resultImage.src = "https://images.unsplash.com/photo-1514989940723-e8e51635b782?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80";
                        resultImage.classList.add('bw-filter');
                    } else {
                        resultImage.src = "https://images.unsplash.com/photo-1518481852452-9415b262eba4?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80";
                        resultImage.classList.remove('bw-filter');
                    }
                    
                    document.getElementById('message-column').classList.add('hidden');
                    document.getElementById('result-column').classList.remove('hidden');
                    
                    showNotification('¬°Retrato generado con √©xito!');
                    isGenerating = false;
                    updateGenerateButton();
                }, 3000);
                
            } catch (error) {
                console.error('Error:', error);
                showAlert('Error', 'No se pudo generar el retrato. Intenta con im√°genes m√°s claras.');
                document.getElementById('message-column').classList.add('hidden');
                document.getElementById('example-column').classList.remove('hidden');
                isGenerating = false;
                updateGenerateButton();
            }
        }

        function downloadImage() {
            const imageSrc = document.getElementById('result-image').src;
            const link = document.createElement('a');
            link.href = imageSrc;
            link.download = `pet-portrait-${selectedStyle}-${Date.now()}.jpg`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            showNotification('Imagen descargada correctamente');
        }

        function resetApp() {
            selfieFile = null;
            dogFiles = [];
            document.getElementById('selfie-input').value = '';
            document.getElementById('dogs-input').value = '';
            document.getElementById('selfie-preview-container').classList.add('hidden');
            document.getElementById('dogs-previews-container').classList.add('hidden');
            document.getElementById('result-column').classList.add('hidden');
            document.getElementById('example-column').classList.remove('hidden');
            updateGenerateButton();
        }

        function setupNotifications() {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            const notificationClose = document.querySelector('.notification-close');
            
            window.showNotification = function(message, type = 'success') {
                notificationText.textContent = message;
                notification.className = 'notification show';
                notification.classList.add(type);
                
                setTimeout(() => {
                    hideNotification();
                }, 5000);
            };
            
            function hideNotification() {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.className = 'notification';
                }, 300);
            }
            
            notificationClose.addEventListener('click', hideNotification);
        }

        function showAlert(title, message) {
            document.getElementById('alert-title').textContent = title;
            document.getElementById('alert-message').textContent = message;
            document.getElementById('custom-alert').classList.remove('hidden');
        }
    </script>
</body>
</html>